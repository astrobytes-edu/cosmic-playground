<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EOS Lab â€” Cosmic Playground</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="../../assets/katex/katex.min.css" />
  </head>
  <body>
    <canvas class="cp-starfield" aria-hidden="true"></canvas>
    <div
      id="cp-demo"
      class="cp-layer-instrument cp-demo"
      data-shell="viz-first"
      aria-label="Equation of state lab instrument"
    >
      <aside class="cp-demo__controls cp-panel" aria-label="Controls panel">
        <div class="cp-panel-header">Equation of State Lab</div>
        <div class="cp-panel-body">
          <p class="cp-muted">
            Compare stellar pressure channels with explicit cgs units and assumption framing.
          </p>

          <div id="radiationClosureChip" class="cp-callout" data-kind="tip" role="note" aria-label="Radiation closure framing">
            <strong id="radiationClosureLabel">LTE closure likely reasonable</strong>
            <div id="radiationClosureNote">
              Radiation pressure uses $P_{\rm rad}=\eta_{\rm rad}aT^4/3$ with default $\eta_{\rm rad}=1$ in optically thick LTE-like conditions.
            </div>
          </div>

          <label class="control">
            <span>Temperature $T$ (K)</span>
            <input
              id="tempSlider"
              type="range"
              min="0"
              max="1000"
              value="500"
              step="1"
              data-tooltip-source="#tempValue"
            />
            <span class="control__value"><span id="tempValue"></span></span>
          </label>

          <label class="control">
            <span>Density $\rho$ (g cm$^{-3}$)</span>
            <input
              id="rhoSlider"
              type="range"
              min="0"
              max="1000"
              value="500"
              step="1"
              data-tooltip-source="#rhoValue"
            />
            <span class="control__value"><span id="rhoValue"></span></span>
          </label>

          <div class="cp-notice">
            <h3>Composition Controls</h3>
            <label class="control">
              <span>Hydrogen mass fraction $X$</span>
              <input
                id="xSlider"
                type="range"
                min="0"
                max="1000"
                value="340"
                step="1"
                data-tooltip-source="#xValue"
              />
              <span class="control__value"><span id="xValue"></span></span>
            </label>
            <label class="control">
              <span>Helium mass fraction $Y$</span>
              <input
                id="ySlider"
                type="range"
                min="0"
                max="1000"
                value="640"
                step="1"
                data-tooltip-source="#yValue"
              />
              <span class="control__value"><span id="yValue"></span></span>
            </label>
            <p class="cp-muted">
              Computed metal fraction $Z = 1 - X - Y$: <span id="zValue"></span>
            </p>
          </div>

          <div class="presets">
            <div class="presets__label">Preset states (ASTR 201)</div>
            <div id="presetButtons" class="presets__grid" role="group" aria-label="Preset states">
              <button class="cp-action cp-action--ghost preset" type="button" data-preset-id="solar-core">Solar core</button>
              <button class="cp-action cp-action--ghost preset" type="button" data-preset-id="solar-envelope">Solar envelope</button>
              <button class="cp-action cp-action--ghost preset" type="button" data-preset-id="massive-core">Massive-star core</button>
              <button class="cp-action cp-action--ghost preset" type="button" data-preset-id="red-giant-envelope">Red giant envelope</button>
              <button class="cp-action cp-action--ghost preset" type="button" data-preset-id="white-dwarf-core">White dwarf core</button>
              <button class="cp-action cp-action--ghost preset" type="button" data-preset-id="brown-dwarf-interior">Brown dwarf interior</button>
            </div>
            <p id="presetNote" class="cp-muted"></p>
          </div>

          <button id="stationMode" class="cp-action" type="button">Station mode</button>
          <button id="help" class="cp-action cp-action--ghost" type="button">Help / shortcuts</button>

          <button id="copyResults" class="cp-action" type="button">Copy results</button>
          <p id="status" class="cp-status" role="status" aria-live="polite" aria-atomic="true"></p>

          <div class="cp-actions">
            <a class="cp-button" href="../../exhibits/eos-lab/">Open exhibit</a>
            <a class="cp-button cp-button--outline" href="../../stations/eos-lab/">Station card</a>
            <a class="cp-button cp-button--outline" href="../../instructor/eos-lab/">Instructor notes</a>
          </div>
        </div>
      </aside>

      <section class="cp-demo__stage cp-stage" aria-label="Pressure comparison stage">
        <div class="pressure-grid" aria-live="off">
          <article id="cardGas" class="pressure-card" data-tone="secondary">
            <h2>$P_{\rm gas}$</h2>
            <p class="pressure-card__value"><span id="pGasValue"></span> <span class="pressure-card__unit">dyne cm$^{-2}$</span></p>
            <div class="pressure-card__bar" aria-hidden="true"><span id="pGasBar"></span></div>
            <p class="pressure-card__hint">Thermal particle collisions; scales as $\rho T$.</p>
          </article>

          <article id="cardRadiation" class="pressure-card" data-tone="secondary">
            <h2>$P_{\rm rad}$</h2>
            <p class="pressure-card__value"><span id="pRadValue"></span> <span class="pressure-card__unit">dyne cm$^{-2}$</span></p>
            <div class="pressure-card__bar" aria-hidden="true"><span id="pRadBar"></span></div>
            <p class="pressure-card__hint">Photon momentum flux; scales as $T^4$ under LTE closure.</p>
          </article>

          <article id="cardDegeneracy" class="pressure-card" data-tone="secondary">
            <h2>$P_{\rm deg,e}$</h2>
            <p class="pressure-card__value"><span id="pDegValue"></span> <span class="pressure-card__unit">dyne cm$^{-2}$</span></p>
            <div class="pressure-card__bar" aria-hidden="true"><span id="pDegBar"></span></div>
            <p class="pressure-card__hint">Quantum correction beyond classical electrons; driven by Pauli exclusion.</p>
          </article>
        </div>

        <div class="stage-summary">
          <p><strong>Total pressure $P_{\rm tot}$:</strong> <span id="pTotalValue"></span> dyne cm$^{-2}$</p>
          <p><strong>Dominant channel:</strong> <span id="dominantChannel"></span></p>
        </div>

        <section class="regime-map" aria-label="EOS regime map">
          <h3>Regime Map ($\log_{10}\rho$ vs $\log_{10}T$)</h3>
          <svg
            id="regimeMap"
            viewBox="0 0 100 100"
            role="img"
            aria-label="EOS dominance map over log density and log temperature"
            preserveAspectRatio="none"
          >
            <g id="regimeCells"></g>
            <g id="regimePresetMarkers"></g>
            <circle id="regimeCurrentPoint" cx="50" cy="50" r="2.6"></circle>
          </svg>
          <p id="regimeSummary" class="cp-muted"></p>
        </section>
      </section>

      <aside class="cp-demo__readouts cp-panel" aria-label="Readouts panel">
        <div class="cp-panel-header">Readouts</div>
        <div class="cp-panel-body">
          <div class="cp-readout">
            <div class="cp-readout__label">$\mu$ (mean mass per particle in $m_u$)</div>
            <div class="cp-readout__value">
              <span id="muValue"></span>
              <span class="cp-readout__unit">m_u</span>
            </div>
          </div>
          <div class="cp-readout">
            <div class="cp-readout__label">$\mu_e$ (mean mass per electron in $m_u$)</div>
            <div class="cp-readout__value">
              <span id="muEValue"></span>
              <span class="cp-readout__unit">m_u</span>
            </div>
          </div>
          <div class="cp-readout">
            <div class="cp-readout__label">$\beta=P_{\rm gas}/P_{\rm tot}$</div>
            <div class="cp-readout__value"><span id="betaValue"></span></div>
          </div>
          <div class="cp-readout">
            <div class="cp-readout__label">$P_{\rm rad}/P_{\rm gas}$</div>
            <div class="cp-readout__value">
              <span id="radGasValue"></span>
              <span class="cp-readout__unit">ratio</span>
            </div>
          </div>
          <div class="cp-readout">
            <div class="cp-readout__label">$P_{\rm deg,e}/P_{\rm tot}$</div>
            <div class="cp-readout__value"><span id="degTotalValue"></span></div>
          </div>
          <div class="cp-readout">
            <div class="cp-readout__label">$\chi_{\rm deg}=T/T_F$</div>
            <div class="cp-readout__value"><span id="chiDegValue"></span></div>
            <div class="cp-muted" id="degRegimeValue"></div>
          </div>
          <div class="cp-notice">
            <h3>Composition interpretation</h3>
            <p class="cp-muted">
              Smaller $\mu$ means more particles per gram, so gas pressure increases at fixed $(\rho,T)$.
            </p>
          </div>
          <div class="cp-notice">
            <h3>Advanced diagnostics</h3>
            <p class="cp-muted">Fermi momentum regime + extension pathway diagnostics.</p>
            <div class="cp-readout">
              <div class="cp-readout__label">$x_F=p_F/(m_e c)$</div>
              <div class="cp-readout__value">
                <span id="xFValue"></span>
                <span class="cp-readout__unit">ratio</span>
              </div>
            </div>
            <div class="cp-readout">
              <div class="cp-readout__label">Fermi relativity regime</div>
              <div class="cp-readout__value">
                <span id="fermiRegimeValue"></span>
              </div>
            </div>
            <div class="cp-readout">
              <div class="cp-readout__label">Sommerfeld factor $1+\frac{5\pi^2}{12}\left(T/T_F\right)^2$</div>
              <div class="cp-readout__value">
                <span id="finiteTCorrectionValue"></span>
                <span class="cp-readout__unit">factor</span>
              </div>
              <div class="cp-muted" id="finiteTValidityValue"></div>
            </div>
            <div class="cp-readout">
              <div class="cp-readout__label">Neutron extension pressure</div>
              <div class="cp-readout__value">
                <span id="neutronExtensionValue"></span>
                <span class="cp-readout__unit">dyne cm$^{-2}$</span>
              </div>
            </div>
          </div>
        </div>
      </aside>

      <section class="cp-demo__drawer cp-drawer" aria-label="Panels">
        <div class="cp-panels">
          <details class="cp-accordion" open>
            <summary>
              <span class="cp-accordion__title">What to notice</span>
              <span class="cp-accordion__meta">3 prompts</span>
            </summary>
            <div class="cp-accordion__body">
              <ul>
                <li>At fixed density, radiation pressure climbs much faster with $T$ than gas pressure.</li>
                <li>At high density, electron degeneracy can dominate even when thermal pressure is large.</li>
                <li>Composition shifts $\mu$ and $\mu_e$, changing both gas and degeneracy channels.</li>
              </ul>
            </div>
          </details>

          <details class="cp-accordion">
            <summary>
              <span class="cp-accordion__title">Model notes</span>
              <span class="cp-accordion__meta">cgs + assumptions</span>
            </summary>
            <div class="cp-accordion__body">
              <ul>
                <li>Gas pressure: $P_{\rm gas}=\rho k_B T/(\mu m_u)$.</li>
                <li>Radiation pressure: $P_{\rm rad}=\eta_{\rm rad} aT^4/3$ (default $\eta_{\rm rad}=1$).</li>
                <li>Finite-$T$ electron EOS uses Fermi-Dirac pressure $P_{e,\rm FD}(n_e,T)$ with nonrelativistic and relativistic branches.</li>
                <li>Displayed degeneracy channel is $P_{\rm deg,e}=\max\!\left(P_{e,\rm FD}-n_e k_B T,0\right)$.</li>
                <li>
                  Finite-$T$ proxy uses $1+\frac{5\pi^2}{12}\left(T/T_F\right)^2$ only when $x_F\ll1$ and $T/T_F\ll1$.
                </li>
                <li>$\mu$ and $\mu_e$ for fully ionized mixtures: $\mu^{-1}\approx2X+\frac{3}{4}Y+\frac{1}{2}Z$, $\mu_e^{-1}\approx X+\frac{Y}{2}+\frac{Z}{2}$.</li>
                <li>
                  Future hook: the kernel accepts additional pressure terms and alternate degeneracy providers for pair-rich and neutron extensions.
                </li>
              </ul>
            </div>
          </details>

          <details class="cp-accordion">
            <summary>
              <span class="cp-accordion__title">Deep Dive: Gas Pressure</span>
              <span class="cp-accordion__meta">cause + limits</span>
            </summary>
            <div class="cp-accordion__body">
              <p><strong>Physical cause:</strong> momentum transfer from thermal particle collisions.</p>
              <p><strong>Limits:</strong> assumes ideal fully ionized plasma; no Coulomb or partial-ionization corrections.</p>
            </div>
          </details>

          <details class="cp-accordion">
            <summary>
              <span class="cp-accordion__title">Deep Dive: Radiation Pressure</span>
              <span class="cp-accordion__meta">cause + limits</span>
            </summary>
            <div class="cp-accordion__body">
              <p><strong>Physical cause:</strong> photon momentum flux from a near-thermal radiation field.</p>
              <p><strong>Limits:</strong> LTE closure can fail in optically thin or strongly non-equilibrium regimes.</p>
            </div>
          </details>

          <details class="cp-accordion">
              <summary>
                <span class="cp-accordion__title">Deep Dive: Degeneracy Pressure</span>
                <span class="cp-accordion__meta">cause + limits</span>
              </summary>
              <div class="cp-accordion__body">
                <p><strong>Physical cause:</strong> Pauli exclusion fills momentum states even at low temperature.</p>
                <p><strong>Limits:</strong> finite-$T$ Fermi-Dirac electrons are included, but Coulomb/ion corrections and neutron-star matter channels are intentionally out of scope.</p>
              </div>
            </details>
        </div>
      </section>
    </div>
    <script type="module" src="./main.ts"></script>
  </body>
</html>
