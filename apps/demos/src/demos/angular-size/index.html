<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Angular Size — Cosmic Playground</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="../../assets/katex/katex.min.css" />
  </head>
  <body>
    <canvas class="cp-starfield" aria-hidden="true"></canvas>
    <div id="cp-demo" class="cp-layer-instrument cp-demo" aria-label="Angular Size instrument">
      <aside class="cp-demo__controls cp-panel" aria-label="Controls panel">
        <div class="cp-panel-header">Angular Size: The Sky’s Ruler</div>
        <div class="cp-panel-body">
          <p class="cp-muted">Compare apparent sizes and see why distance matters.</p>

          <div class="cp-callout" data-kind="tip">
            <strong>Quick sky rule</strong>
            <div>
              Your thumb at arm’s length covers about <strong>$2^\circ$</strong>. The Sun and Moon are about <strong>$0.5^\circ$</strong>.
            </div>
          </div>

          <label class="control">
            <span>Preset</span>
            <select id="preset"></select>
          </label>

          <label class="control">
            <span>Distance $d$ (km)</span>
            <input
              id="distanceSlider"
              type="range"
              min="0"
              max="1000"
              value="500"
              step="1"
              data-tooltip-source="#distanceValue"
            />
            <span class="control__value"><span id="distanceValue"></span></span>
          </label>

          <label class="control">
            <span>Diameter $D$ (km)</span>
            <input
              id="diameterSlider"
              type="range"
              min="0"
              max="1000"
              value="500"
              step="1"
              data-tooltip-source="#diameterValue"
            />
            <span class="control__value"><span id="diameterValue"></span></span>
          </label>

          <section id="moonControls" class="cp-notice" aria-label="Moon controls" hidden>
            <h3>Moon time mode</h3>
            <div class="cp-muted">
              The Moon’s apparent size changes across its orbit, and its distance changes slowly over geologic time.
            </div>

            <div class="radio-row" role="radiogroup" aria-label="Moon time mode">
              <label class="radio">
                <input id="moonModeOrbit" type="radio" name="moonMode" value="orbit" checked />
                Orbit (perigee ↔ apogee)
              </label>
              <label class="radio">
                <input id="moonModeRecession" type="radio" name="moonMode" value="recession" />
                Recession (Myr from today)
              </label>
            </div>

            <label id="moonOrbitRow" class="control">
              <span>Orbit angle (deg)</span>
              <input
                id="moonOrbitAngle"
                type="range"
                min="0"
                max="360"
                value="0"
                step="1"
                data-tooltip-source="#moonOrbitValue"
              />
              <span class="control__value"><span id="moonOrbitValue"></span></span>
            </label>

            <label id="moonRecessionRow" class="control" hidden>
              <span>Recession time (Myr)</span>
              <input
                id="moonRecessionTime"
                type="range"
                min="-1000"
                max="1000"
                value="0"
                step="10"
                data-tooltip-source="#moonRecessionValue"
              />
              <span class="control__value"><span id="moonRecessionValue"></span></span>
            </label>
          </section>

          <button id="stationMode" class="cp-action" type="button">Station mode</button>
          <button id="challengeMode" class="cp-action" type="button" disabled>Challenge mode</button>
          <button id="help" class="cp-action" type="button">Help / shortcuts</button>

          <button id="copyResults" class="cp-action" type="button">Copy results</button>
          <div class="cp-muted">
            Station Mode builds a snapshot table. Challenge Mode gives goals to hit. Copy Results exports the current state.
          </div>
          <p id="status" class="cp-status" role="status" aria-live="polite" aria-atomic="true"></p>

          <div class="cp-actions">
            <a class="cp-button" href="../../exhibits/angular-size/">Open exhibit</a>
            <a class="cp-button cp-button--outline" href="../../stations/angular-size/">Station card</a>
            <a class="cp-button cp-button--outline" href="../../instructor/angular-size/">Instructor notes</a>
          </div>
        </div>
      </aside>

      <section class="cp-demo__stage cp-stage stage" aria-label="Visualization stage">
        <svg
          id="stageSvg"
          class="stage__svg"
          viewBox="0 0 640 360"
          role="img"
          aria-label="Angular size visualization"
        >
          <defs>
            <radialGradient id="sunGlow">
              <stop offset="0%" stop-color="var(--cp-celestial-sun-core)" stop-opacity="0.98" />
              <stop offset="70%" stop-color="var(--cp-celestial-sun)" stop-opacity="0.88" />
              <stop offset="100%" stop-color="var(--cp-celestial-sun-corona)" stop-opacity="0.35" />
            </radialGradient>

            <radialGradient id="moonGlow" cx="30%" cy="30%">
              <stop offset="0%" stop-color="var(--cp-celestial-moon)" stop-opacity="0.98" />
              <stop offset="100%" stop-color="var(--cp-celestial-moon-dark)" stop-opacity="0.35" />
            </radialGradient>

            <radialGradient id="planetGlow" cx="35%" cy="35%">
              <stop offset="0%" stop-color="var(--cp-celestial-earth)" stop-opacity="0.95" />
              <stop offset="100%" stop-color="var(--cp-celestial-earth)" stop-opacity="0.25" />
            </radialGradient>

            <radialGradient id="marsGlow" cx="35%" cy="35%">
              <stop offset="0%" stop-color="var(--cp-celestial-mars)" stop-opacity="0.95" />
              <stop offset="100%" stop-color="var(--cp-celestial-mars)" stop-opacity="0.25" />
            </radialGradient>

            <radialGradient id="galaxyGlow" cx="35%" cy="35%">
              <stop offset="0%" stop-color="var(--cp-celestial-orbit)" stop-opacity="0.92" />
              <stop offset="100%" stop-color="var(--cp-celestial-orbit)" stop-opacity="0.22" />
            </radialGradient>

            <radialGradient id="objectGlow" cx="40%" cy="30%">
              <stop offset="0%" stop-color="var(--cp-celestial-star)" stop-opacity="0.95" />
              <stop offset="100%" stop-color="var(--cp-celestial-star)" stop-opacity="0.3" />
            </radialGradient>
          </defs>

          <g id="observer" aria-hidden="true">
            <circle class="stage__observer" cx="90" cy="180" r="18" />
            <circle class="stage__observer-eye" cx="95" cy="176" r="6" />
            <circle class="stage__observer-eyeHighlight" cx="97" cy="174" r="2" />
            <text class="stage__label" x="90" y="215" text-anchor="middle">Observer</text>
          </g>

          <g id="rays" aria-hidden="true">
            <line id="rayTop" class="stage__ray" x1="90" y1="180" x2="520" y2="140" />
            <line id="rayBottom" class="stage__ray" x1="90" y1="180" x2="520" y2="220" />
          </g>

          <path id="angleArc" class="stage__angleArc" d="" aria-hidden="true"></path>

          <g id="object" aria-hidden="true">
            <circle id="objectCircle" class="stage__object" cx="520" cy="180" r="42" fill="url(#objectGlow)" />
          </g>

          <g id="indicators" aria-hidden="true">
            <line id="sizeLine" class="stage__sizeLine" x1="520" y1="140" x2="520" y2="220" />
            <text id="sizeStageLabel" class="stage__metricLabel" x="544" y="180" text-anchor="start"></text>

            <line id="distanceLine" class="stage__distanceLine" x1="120" y1="300" x2="520" y2="300" />
            <line class="stage__distanceTick" x1="120" y1="294" x2="120" y2="306" />
            <line class="stage__distanceTick" x1="520" y1="294" x2="520" y2="306" />
            <text id="distanceStageLabel" class="stage__metricLabel" x="320" y="326" text-anchor="middle"></text>

            <text id="objectLabel" class="stage__label stage__label--object" x="520" y="116" text-anchor="middle"></text>
          </g>

          <text id="angleLabel" class="stage__angle" x="120" y="48"></text>
          <text id="noteLabel" class="stage__note" x="120" y="72">
            Diagram is visually scaled; numeric readouts are authoritative.
          </text>
        </svg>
      </section>

      <aside class="cp-demo__readouts cp-panel" aria-label="Readouts panel">
        <div class="cp-panel-header">Readouts</div>
        <div class="cp-panel-body">
          <div class="cp-readout">
            <div class="cp-readout__label">Angular diameter $\theta$ (display)</div>
            <div class="cp-readout__value"><span id="thetaDisplay"></span></div>
          </div>
          <div class="cp-readout">
            <div class="cp-readout__label">Angular diameter $\theta$ (deg)</div>
            <div class="cp-readout__value"><span id="thetaDeg"></span></div>
          </div>
          <div class="cp-readout">
            <div class="cp-readout__label">Diameter $D$ (km)</div>
            <div class="cp-readout__value"><span id="diameterKm"></span></div>
          </div>
          <div class="cp-readout">
            <div class="cp-readout__label">Distance $d$ (km)</div>
            <div class="cp-readout__value"><span id="distanceKm"></span></div>
          </div>
        </div>
      </aside>

      <section class="cp-demo__drawer cp-drawer" aria-label="Panels">
        <div class="cp-panels">
          <details class="cp-accordion" open>
            <summary>
              <span class="cp-accordion__title">What to notice</span>
              <span class="cp-accordion__meta">2 bullets</span>
            </summary>
            <div class="cp-accordion__body">
              <ul>
                <li>Nearer objects look larger even if they are smaller.</li>
                <li>Different (size, distance) pairs can look the same.</li>
              </ul>
            </div>
          </details>

          <details class="cp-accordion">
            <summary>
              <span class="cp-accordion__title">Model notes</span>
              <span class="cp-accordion__meta">geometry</span>
            </summary>
            <div class="cp-accordion__body">
              <ul>
                <li>
                  Exact geometry:
                  $$\theta = 2\tan^{-1}\left(\frac{D}{2d}\right)$$
                </li>
                <li>$D$ is physical diameter (km). $d$ is distance from the observer to the object (km).</li>
                <li>
                  Small-angle approximation (when $D \ll d$):
                  $$\theta \approx \frac{D}{d}\ \text{(radians)}$$
                  $$\theta_{\mathrm{deg}} \approx \frac{180}{\pi}\,\frac{D}{d}$$
                </li>
                <li>Units: internal distance/diameter are always km; $\theta$ may display in $^\circ$ / $^\prime$ / $^{\prime\prime}$.</li>
                <li>This is a geometry model (no lensing, no atmospheric effects, no finite detector resolution).</li>
              </ul>
            </div>
          </details>
        </div>
      </section>
    </div>
    <script type="module" src="./main.ts"></script>
  </body>
</html>
