---
import Layout from "../layouts/Layout.astro";
import StatBar from "../components/StatBar.astro";
import CitationCard from "../components/CitationCard.astro";
import PPEVisual from "../components/PPEVisual.astro";

const withBase = (path: string) => {
  const base = import.meta.env.BASE_URL;
  const normalizedBase = base.endsWith("/") ? base : `${base}/`;
  const normalizedPath = path.startsWith("/") ? path.slice(1) : path;
  return `${normalizedBase}${normalizedPath}`;
};

const stats = [
  { value: "14", unit: "interactive demos" },
  { value: "3", unit: "modes per demo", label: "Station / Challenge / Export" },
  { value: "0", unit: "logins required" },
  { value: "8", unit: "topic areas" },
];

const citations = [
  {
    authors: "Freeman et al.",
    year: "2014",
    finding:
      "Active learning reduces failure rates by 1.5\u00d7 and increases exam scores by 0.47 standard deviations compared to traditional lecturing.",
    connection:
      "Interactive simulations with structured inquiry are a core active learning strategy used throughout Cosmic Playground.",
  },
  {
    authors: "Mazur",
    year: "1997",
    finding:
      "Conceptual understanding improves when students commit to predictions before receiving feedback.",
    connection:
      "The foundation of our Predict phase \u2014 every demo begins with a written prediction prompt.",
  },
  {
    authors: "Bardar et al.",
    year: "2007",
    finding:
      "Targeted interactive instruction produces statistically significant gains in understanding of moon phases.",
    connection:
      "Moon Phases was our first demo, specifically targeting this persistent misconception.",
  },
  {
    authors: "White & Gunstone",
    year: "1992",
    finding:
      "The Predict\u2013Observe\u2013Explain framework structures conceptual change by surfacing and confronting misconceptions.",
    connection:
      "We adapt POE by replacing passive \u201cObserve\u201d with active \u201cPlay\u201d \u2014 students manipulate parameters and collect data.",
  },
  {
    authors: "Haynes et al.",
    year: "2004",
    finding:
      "Embedding assessment directly within interactive simulations captures reasoning processes that traditional pre/post instruments miss, providing ecological validity for measuring conceptual change.",
    connection:
      "Our assessment strategy prioritizes authentic, embedded measures \u2014 prediction accuracy, explanation quality, and reasoning under novelty \u2014 over standardized recall-based instruments.",
  },
];
---

<Layout title="About \u2014 Cosmic Playground" hasMath={true}>
  <section class="hero cp-hero">
    <h1>About Cosmic Playground</h1>
    <p class="hero__subtitle">Evidence-based interactive astronomy education</p>
    <p>
      An open-source collection of browser-based astronomy instruments designed
      for active learning in introductory and upper-division courses.
    </p>
  </section>

  {/* ───── At a Glance (stat bar) ───── */}
  <section class="about-section" aria-label="At a Glance">
    <h2>At a Glance</h2>
    <StatBar stats={stats} />
    <div class="cp-prose">
      <p>
        No login, no install. Each demo ships with <strong>Station Mode</strong> (structured
        data collection), <strong>Challenge Mode</strong> (self-assessment), and
        <strong>Export</strong> (copy your table into a lab doc).
      </p>
      <table class="design-table">
        <thead>
          <tr><th>Design choice</th><th>Why</th></tr>
        </thead>
        <tbody>
          <tr>
            <td>Station Mode data tables</td>
            <td>Bridges "toy" to "science" — students produce exportable evidence</td>
          </tr>
          <tr>
            <td>Predict before Play</td>
            <td>Committing to a prediction activates prior knowledge (Mazur 1997)</td>
          </tr>
          <tr>
            <td>Sanity checks on every card</td>
            <td>Self-correction without instructor bottleneck</td>
          </tr>
          <tr>
            <td>One relationship per demo</td>
            <td>Minimizes cognitive load (Sweller 1988); advanced options are hidden</td>
          </tr>
          <tr>
            <td>Print-first worksheets</td>
            <td>Classrooms still run on paper; Cmd+P produces clean PDFs</td>
          </tr>
          <tr>
            <td>Connection sentences</td>
            <td>Forces transfer: "This matters for X because..." prevents isolated activities</td>
          </tr>
        </tbody>
      </table>
      <p>
        <strong>Honest caveat:</strong> no pre/post assessment data yet. The design
        is grounded in published PER (see <a href="#evidence">Evidence Base</a> below),
        but the real test is measuring reasoning gains (prediction accuracy,
        explanation quality) in a live classroom.
      </p>
    </div>
  </section>

  {/* ───── Predict–Play–Explain (visual) ───── */}
  <section class="about-section" aria-label="The Predict-Play-Explain Framework">
    <h2>The Predict\u2013Play\u2013Explain Framework</h2>
    <div class="cp-prose">
      <p>
        Our pedagogical scaffold adapts the classic <strong>Predict\u2013Observe\u2013Explain</strong>
        (POE) framework of White &amp; Gunstone (1992), with one key modification: we replace
        passive "Observe" with active <strong>"Play."</strong> Students don't just watch a
        simulation — they manipulate parameters, collect data, and test their own predictions.
      </p>
    </div>
    <div class="ppe-container">
      <PPEVisual />
    </div>
    <div class="cp-prose">
      <p>
        This three-phase cycle runs in 6–12 minutes per station, making it suitable for
        lecture warm-ups, lab activities, and multi-station rotations.
      </p>
    </div>
  </section>

  {/* ───── Design Principles (collapsible) ───── */}
  <section class="about-section" aria-label="Design Principles">
    <details class="collapsible">
      <summary class="collapsible__trigger">
        <h2 class="collapsible__heading">Design Principles</h2>
      </summary>
      <div class="collapsible__body cp-prose">
        <dl class="principles">
          <dt>Cognitive Load Theory</dt>
          <dd>
            Following Sweller (1988), each demo minimizes extraneous load by presenting
            one governing relationship at a time. Controls are limited to the essential
            parameters; advanced options are hidden behind progressive disclosure.
          </dd>
          <dt>Multimedia Learning</dt>
          <dd>
            Consistent with Mayer (2001), text and visuals are spatially and temporally
            integrated. Readouts update in real time next to the visual they describe.
            Decorative elements are minimized — every visual element encodes data.
          </dd>
          <dt>PhET-Inspired Interactivity</dt>
          <dd>
            Inspired by the PhET Interactive Simulations project (Wieman et al., 2008),
            demos are designed for <em>productive exploration</em>: students can discover
            relationships by dragging sliders, not by reading instructions. Immediate,
            continuous feedback makes cause-and-effect relationships visible.
          </dd>
          <dt>Station Mode as Scaffolded Data Collection</dt>
          <dd>
            Every demo includes a Station Mode that converts free exploration into
            structured data collection. Students add rows to a live table, then export the
            data for use in lab reports. This bridges the gap between "playing with a toy"
            and "doing science."
          </dd>
        </dl>
      </div>
    </details>
  </section>

  {/* ───── Evidence Base (citation cards) ───── */}
  <section class="about-section" id="evidence" aria-label="Evidence Base">
    <details class="collapsible" open>
      <summary class="collapsible__trigger">
        <h2 class="collapsible__heading">Evidence Base</h2>
      </summary>
      <div class="collapsible__body">
        <p class="evidence-intro">
          The design of Cosmic Playground is informed by decades of physics and
          astronomy education research:
        </p>
        <div class="citation-grid">
          {citations.map((c) => (
            <CitationCard
              authors={c.authors}
              year={c.year}
              finding={c.finding}
              connection={c.connection}
            />
          ))}
        </div>
      </div>
    </details>
  </section>

  {/* ───── For Instructors ───── */}
  <section class="about-section" aria-label="For Instructors">
    <h2>For Instructors</h2>
    <div class="cp-prose">
      <p>
        Cosmic Playground integrates into your existing course with minimal friction:
      </p>
      <ul>
        <li>
          <strong>Station cards</strong> are printable worksheets
          (<a href={withBase("stations/moon-phases/")}>example</a>). Open any station
          card and press <kbd>Cmd</kbd>+<kbd>P</kbd> (or <kbd>Ctrl</kbd>+<kbd>P</kbd>)
          for a clean PDF with answer blanks and data tables.
        </li>
        <li>
          <strong>Playlists</strong> bundle 3–5 demos into themed sequences with
          estimated times (<a href={withBase("playlists/")}>browse playlists</a>).
        </li>
        <li>
          All demos are <strong>free, open-source, and static</strong> — no accounts,
          no server, no IT requests. Host on your own domain or link directly to ours.
        </li>
      </ul>
      <p>
        Questions or suggestions?
        <a href="mailto:alrosen@sdsu.edu">alrosen@sdsu.edu</a>
      </p>
    </div>
  </section>
</Layout>

<style>
  .about-section {
    margin-top: var(--cp-space-6);
  }

  .about-section h2 {
    margin: 0 0 var(--cp-space-3);
    font-size: var(--cp-text-xl);
  }

  .ppe-container {
    margin: var(--cp-space-5) 0;
  }

  /* ── Design table ───────────────────────── */
  .design-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.92rem;
    margin: var(--cp-space-3) 0;
  }

  .design-table th,
  .design-table td {
    text-align: left;
    padding: var(--cp-space-2) var(--cp-space-3);
    border-bottom: 1px solid var(--cp-border-subtle);
  }

  .design-table th {
    font-weight: var(--cp-font-semibold);
    color: var(--cp-text2);
  }

  .design-table td:first-child {
    font-weight: 500;
    white-space: nowrap;
  }

  /* ── Collapsible sections ───────────────── */
  .collapsible {
    border: 1px solid var(--cp-border-subtle);
    border-radius: var(--cp-r-2);
    overflow: hidden;
  }

  .collapsible__trigger {
    display: flex;
    align-items: center;
    gap: var(--cp-space-2);
    padding: var(--cp-space-4);
    cursor: pointer;
    list-style: none;
    transition: background var(--cp-transition-fast) var(--cp-ease-out);
  }

  .collapsible__trigger::-webkit-details-marker {
    display: none;
  }

  .collapsible__trigger::before {
    content: "\25B6";
    font-size: 0.7em;
    color: var(--cp-muted);
    transition: transform var(--cp-transition-fast) var(--cp-ease-out);
  }

  .collapsible[open] > .collapsible__trigger::before {
    transform: rotate(90deg);
  }

  .collapsible__trigger:hover {
    background: color-mix(in srgb, var(--cp-text) 4%, transparent);
  }

  .collapsible__heading {
    margin: 0;
    font-size: var(--cp-text-xl);
  }

  .collapsible__body {
    padding: 0 var(--cp-space-4) var(--cp-space-4);
  }

  /* ── Principles ─────────────────────────── */
  .principles {
    margin: 0;
  }

  .principles dt {
    font-weight: var(--cp-font-semibold);
    margin-top: var(--cp-space-4);
  }

  .principles dt:first-child {
    margin-top: 0;
  }

  .principles dd {
    margin: var(--cp-space-1) 0 0;
    color: var(--cp-muted);
  }

  /* ── Evidence / Citations ───────────────── */
  .evidence-intro {
    margin: 0 0 var(--cp-space-4);
    color: var(--cp-text2);
  }

  .citation-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--cp-space-4);
  }
</style>
